# commonLayout

```jsp
<%@tag pageEncoding="UTF-8"%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>


<head>
<title>나의 페이지</title>

<!-- config -->
<meta charset="UTF-8" />
<meta name="viewport"
		content="width=device-width, initial-scale=1" />
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="css/common.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="js/common.js"></script>
<style>
.fakeimg {
	height: 200px;
	background: #aaa;
}
</style>				

</head>

<body class="container-fluid bg-dark">

	<!-- header -->
	<div id="header-container" 
			class="jumbotron text-center bg-dark text-white"
			style="margin-bottom:0">
			
			<h1 class="display=2">MY PAGE!</h1>
			<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
			<a class="navbar-brand">로그인 하세요!</a>
			<button class="navbar-toggler" type="button"
				data-toggle="collapse" data-target="#nav-items">
				<span class = "navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="nav-items">
				<ul class="navbar-nav">
					<c:if test="${currentMember == null }">
						<li class="nav-item">
							<a class="nav-link active" href="/myhome/member/login.jsp">로그인</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="/myhome/member/join.jsp">회원가입</a>
						</li>
					</c:if>
					
					<c:if test="${currentMember != null }">
						<li class="nav-item">
							<a class="nav-link" href="/myhome/member/logout">로그아웃</a>
						</li>
						<li class="nav-item">
							<a class="nav-link"  href="/myhome/member/modify.jsp">마이페이지</a>
						</li>
					</c:if>
					
					<li class="nav-item">
						<a class="nav-link">게시판</a>
					</li>
					<li class="nav-item">
						<a class="nav-link">파일</a>
					</li>
					
					<c:if test="${currentMember.type == 1 }">
						<li class="nav-item">
							<a class="nav-link" href = "/myhome/admin/manage">Manage</a>
						</li>	
					</c:if>
				</ul>
			</div>
				
			</nav>
			</div>
	
	<!-- main -->
	<div class="container-fluid bg-dark text-white" 
			style="margin-top:30px">
			
		<div class="row">
		<!-- side bar -->
		<div id="sidebar-container" class="col-sm-2">
			<h2>About Me</h2>
				<h5>Photo of me:</h5>
				<div class="fakeimg">Fake Image</div>
				<p>Some text about me in culpa qui officia deserunt mollit
					anim..</p>
				<h3>Some Links</h3>
				<p>Lorem ipsum dolor sit ame.</p>
				<ul class="nav nav-pills flex-column">
					<li class="nav-item"><a class="nav-link active" href="#">Active</a>
					</li>
					<li class="nav-item"><a class="nav-link" href="#">Link</a></li>
					<li class="nav-item"><a class="nav-link" href="#">Link</a></li>
					<li class="nav-item"><a class="nav-link disabled" href="#">Disabled</a>
					</li>
				</ul>
				<hr class="d-sm-none">
		
		</div>
		
		<!-- main(content) -->
		<div id="main.container" class="col-sm-8"><jsp:doBody/></div>
		</div>
		
				
	</div>
	
	<!-- footer -->
	<div id="footer-container"
		class="footer jumbotron-fluid text-center p-3 pg-dark text-white">
		
		<div class="container">
			<p>&copy;2021. JUN. All Rights Reserved</p>
		</div>
		
		
		</div>



</body>


</html>
```



# admin(관리자 페이지)

```jsp
<%@page import="com.myhome.model.MemberDto"%>
<%@page import="com.myhome.model.MemberDao"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@taglib prefix="t" tagdir="/WEB-INF/tags"%>
<%@taglib prefix="c" uri = "http://java.sun.com/jsp/jstl/core" %>

<t:commonLayout>



	<jsp:body>
	<table border = "1" style="color:white">
		<c:forEach var="item" items="${list }" >
		 <tr>
			<td ><c:out value="${item.no}"/></td>
		    <td ><c:out value="${item.id}"/></td>
    		<td ><c:out value="${item.nickname}"/></td>
   			 <td ><c:out value="${item.regdate}"/></td>
   			 </tr>
		



		
		</c:forEach>
		</table>
	</jsp:body>




</t:commonLayout>
```



# MemberDao

```jsp
package com.myhome.model;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

public class MemberDao implements Dao{
	

	private static MemberDao instance;
	private Connection connection;
	private PreparedStatement preparedStatement;
	private ResultSet resultSet;
	
	
	private MemberDao() {}
		
	public static MemberDao getInstance() {
		if(instance == null)
				instance = new MemberDao();
		return instance;
	}
	
	
	// public MemberDTO select(int no)
	// ~> SELECT no, id, password, nickname, type, regdate 
	//	  	FROM member
	//	  WHERE no = ?
	public MemberDto select(int no) {
		
		String sql = "SELECT no, id, password, nickname, type, regdate"
					+ " FROM member"
					+ " WHERE no = ?";
		MemberDto dto = null;
		try {
			connection = getConnection();
			preparedStatement = connection.prepareStatement(sql);
			preparedStatement.setInt(1, no);
			resultSet = preparedStatement.executeQuery();
			if(resultSet.next()) {
				dto = new MemberDto();
				dto.setNo(resultSet.getInt("no"));
				dto.setId(resultSet.getString("id"));
				dto.setPassword(resultSet.getString("password"));
				dto.setNickname(resultSet.getString("nickname"));
				dto.setType(resultSet.getInt("type"));
				dto.setRegdate(resultSet.getString("regdate"));
		
				
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}finally {
			close(connection, preparedStatement, resultSet);
		}
		return dto;
	}
	
	
	
	
	// public list<MemberDTO> selectAll()
	//~> SELECT no, id, password, nickname, type, regdate
	//  FROM member
	//  ORDER BY regdate DESC
	public List<MemberDto> selectAll(){
		String sql = "SELECT no, id, password, nickname, type, regdate "
					+ "FROM member "
					+ "ORDER BY regdate DESC";
		List<MemberDto> list= new ArrayList<MemberDto>();
		try {
			connection = getConnection();
			preparedStatement = connection.prepareStatement(sql);
			resultSet = preparedStatement.executeQuery();
			while(resultSet.next()) {
				MemberDto dto = new MemberDto();
				dto.setNo(resultSet.getInt("no"));
				dto.setId(resultSet.getString("id"));
				dto.setPassword(resultSet.getString("password"));
				dto.setNickname(resultSet.getString("nickname"));
				dto.setType(resultSet.getInt("type"));
				dto.setRegdate(resultSet.getString("regdate"));
				list.add(dto);
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}finally {
			close(connection, preparedStatement, resultSet);
		}
		return list;
	}
	
	
	// public boolean delete(int no)
	// ~> DELETE FROM member
	//	  WHERE no = ?
	public boolean delete(int no) {
		
		String sql="DELETE FROM member "
				+ "WHERE no = ?";
		boolean result = false;
		try {
			connection = getConnection();
			preparedStatement = connection.prepareStatement(sql);
			preparedStatement.setInt(1, no);
			result = preparedStatement.executeUpdate() > 0; 
			
		}catch(SQLException e) {
			e.printStackTrace();
		}finally {
			close(connection, preparedStatement);
		}
		return result;
	}
	
	// public boolean update(MemberDTO dto)
	//~> UPDATE member
	//	 SET password = ?, nickname = ?
	//	 WHERE no = ?
	public boolean update(MemberDto dto) {
		
		String sql = "UPDATE member "
					+ "SET password = ?, nickname = ? "
					+ "WHERE no = ?";
		boolean result = false;
		try {
			connection = getConnection();
			preparedStatement = connection.prepareStatement(sql);
			preparedStatement.setString(1, dto.getPassword());
			preparedStatement.setString(2, dto.getNickname());
			preparedStatement.setInt(3, dto.getNo());
			result = preparedStatement.executeUpdate() > 0; 
					
					
		}catch(SQLException e) {
			e.printStackTrace();
		}finally {
			close(connection,preparedStatement);
		}
		return result;
	}
	
	public MemberDto login(String id, String password) {
		String sql = "SELECT * FROM member WHERE id = ? and password = ?";
		MemberDto dto = null; // 새로운 dto
		boolean result = false; 
		try {
			connection = getConnection();
			preparedStatement = connection.prepareStatement(sql);
			preparedStatement.setString(1, id);
			preparedStatement.setString(2, password);
			
			resultSet = preparedStatement.executeQuery();
			  if(resultSet.next()) {
				  dto = new MemberDto();
					dto.setNo(resultSet.getInt("no"));
					dto.setId(resultSet.getString("id"));
					dto.setPassword(resultSet.getString("password"));
					dto.setNickname(resultSet.getString("nickname"));
					dto.setType(resultSet.getInt("type"));
					dto.setRegdate(resultSet.getString("regdate"));
				}
			  } catch (SQLException e) {
					e.printStackTrace();
				}finally {
					close(connection, preparedStatement, resultSet);
				}
				return dto;
	}
	
	
	
	// public boolean insert(MemberDTO dto)
	//~> INSERT INTO member(id, password, nickname, type)
	//	 VALUES(?, ?, ?, ?)
	public boolean insert(MemberDto dto) {
		String sql = "INSERT INTO member(id, password, nickname, type) "
				+	"VALUES(?, ?, ?, ?)";
		boolean result = false;
		try {
			connection = getConnection();
			preparedStatement = connection.prepareStatement(sql);
			preparedStatement.setString(1, dto.getId());
			preparedStatement.setString(2, dto.getPassword());
			preparedStatement.setString(3, dto.getNickname());
			preparedStatement.setInt(4, dto.getType());
			
			result = preparedStatement.executeUpdate() > 0;
			
		}catch(SQLException e) {
			e.printStackTrace();
		}finally {
			close(connection,preparedStatement);
		}
		return result;
	}
	public MemberDto selectByIdAndPassword(String id, String password) {
		String sql = "SELECT no, id, password, nickname, type, regdate "
					+ "FROM member "
					+ "WHERE id = ? AND password = ?";
		MemberDto dto = null;
		try {
			connection = getConnection();
			preparedStatement = connection.prepareStatement(sql);
			preparedStatement.setString(1, id);
			preparedStatement.setString(2, password);
			resultSet = preparedStatement.executeQuery();
			
			if(resultSet.next()) {
				dto = new MemberDto();
				dto.setNo(resultSet.getInt("no"));
				dto.setId(resultSet.getString("id"));
				dto.setNickname(resultSet.getString("nickname"));
				dto.setType(resultSet.getInt("type"));
				dto.setRegdate(resultSet.getString("regdate"));
			}
		}catch(SQLException e) {
			e.printStackTrace();
		}finally {
			close(connection,preparedStatement);
		}
		return dto;
	}
}
```



